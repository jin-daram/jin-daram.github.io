{"componentChunkName":"component---src-templates-post-jsx","path":"/ocr/","result":{"data":{"site":{"siteMetadata":{"title":"Let's solve it"}},"markdownRemark":{"id":"d5c52b55-5a00-5a23-8159-1b8e49774824","excerpt":"재직중인 회사에서 서비스하는 제품 중 OCR을 이용해 문서 파일의 글자를 추출하고, 이를 기반으로 제목을 추정하는 기능이 포함 되어있다. 나는 감사하게도 NAVER CLOVA OCR과 서비스를 연동하고, 추출된 텍스트를 기반으로 문서 제목을 추정하는 기능 개발/개선에 참여했다. 제목 추출 알고리즘의 초기  기본적으로 이미지 혹은 PDF 파일을 OCR 처리…","html":"<p>재직중인 회사에서 서비스하는 제품 중 OCR을 이용해 문서 파일의 글자를 추출하고, 이를 기반으로 제목을 추정하는 기능이 포함 되어있다.</p>\n<p>나는 감사하게도 NAVER CLOVA OCR과 서비스를 연동하고, 추출된 텍스트를 기반으로 문서 제목을 추정하는 기능 개발/개선에 참여했다.</p>\n<h2 id=\"제목-추출-알고리즘의-초기\" style=\"position:relative;\"><a href=\"#%EC%A0%9C%EB%AA%A9-%EC%B6%94%EC%B6%9C-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98%EC%9D%98-%EC%B4%88%EA%B8%B0\" aria-label=\"제목 추출 알고리즘의 초기 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>제목 추출 알고리즘의 초기</h2>\n<br>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/070af78ac88545a0d6dcd7cf10d151d1/f97d7/1.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 37.05882352941176%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAABfElEQVR42mWR3WsTQRTF94/2wRefRAQRfK4KQmmrVCtCLZGmYlJbKzGNaUzTtAUfFOvKls0m7c7sfOz+3DsxInjhwB3umXPunInSNMUUBq01Siu8KTlPRnR+7DOIu3S/feTossMw7lPWM+EItygKZrMZSs3PxhhEK5pmU6TKsqrhQz9OBxxctDhOe3S+79GbfOAwPggzX3Oqqgq9iJZlyaLEIGqPmzwdP6J93sRpHzYQN20U1hkus4RnvSfsn7ax2oZ5rnJynQeB/wRfD15w7/0tNofPKQvQhQ5P0LrAW0+cxNxu3WD90/LfuXMuCAhP+oVolmVEW19estS/T2P8CiwYa7DWBjjnucqv6FzscfZrFAwEZz9P2Bk2+Py1GzKXO977eYZvh29YOVqiddqE2tg6G1wXEKJUVWcsEQhnc7TO3d2brB0+pvpzR7acTCZEO4MGK72HvDvZxigb8pGf+xe5up7nVsMpz9bxBg8ad9jorzJTU7SSX9ckScJvklsIoYtc9ukAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='1' title='' src='/static/070af78ac88545a0d6dcd7cf10d151d1/ca1dc/1.png' srcset='/static/070af78ac88545a0d6dcd7cf10d151d1/e7570/1.png 170w,\n/static/070af78ac88545a0d6dcd7cf10d151d1/f46e7/1.png 340w,\n/static/070af78ac88545a0d6dcd7cf10d151d1/ca1dc/1.png 680w,\n/static/070af78ac88545a0d6dcd7cf10d151d1/02d09/1.png 1020w,\n/static/070af78ac88545a0d6dcd7cf10d151d1/9d567/1.png 1360w,\n/static/070af78ac88545a0d6dcd7cf10d151d1/f97d7/1.png 2000w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>기본적으로 이미지 혹은 PDF 파일을 OCR 처리를 하게 되면 위와 같이 글자로 인식한 부분에 대해서 Bounding Box로 인식된다. </p>\n<blockquote>\n<p><strong>Bounding Box란?</strong> <br>\n한 이미지를 OCR 처리하면 결과로 단어 혹은 문장의 위치 기반의 좌표값이 나온다. 이 때 해당 좌표를 기반으로 사각형을 구성한 것을 Bouding Box 라고 칭한다.</p>\n</blockquote>\n<p>처음에는 단순히가장 상단 그리고 중앙에 있는 Bounding Box 중 높이가 가장 큰 Bounding Box를 제목으로 선정했다. 개발 시에 정해진 문서 양식만 올라온다고 가정했기에, 이렇게 간단한 알고리즘을 구성해서 문제를 해결할 수 있었다.</p>\n<p>하지만 요구사항과 '제목이 중앙에 오는 문서', '제목이 2줄인 문서', '소제목이 있는 문서' 등과 같이 업로드 되는 문서의 양식이 다양해지면서 기능 이슈에 대한 피드백이 있었다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 251px; '>\n      <a class='gatsby-resp-image-link' href='/static/fe4345dbfe36a4add2a411a1606946ed/c0f59/3.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 73.52941176470587%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB0klEQVR42o1T16oCUQz0T6xr7xUVEXXF3rGLgiAiPoj//zAygcixXe5DyNnsnsnMbOKwLAuBQAA+nw88M3j2er3w+/3weDxS4zPPbrdb6rzDusvlegkHi6VSCafTCZvNBuPxGNvtFoPBAPP5HNfrFf1+X/L5fMZisUC320WxWBRgNngBZDGdTgtQvV5HtVpFp9OR3Gg0sFwuUS6XBbTX66HZbKJSqSCbzQrLD4bBYBAMp9MpsiiX0nhmsG5KUwsIRjIfgHwRiUSkYyqVQjweRyKRQCaTkTPZx2Ixec9aMplEOBx+NvvqYaFQwOVyweFwwHq9Fsm73U4yfaXs2+2G+/2O6XQqDQj4DvaUTIbKjGbzbAYbkr0qiEajvxlSMkF1ZEyPdJxMT3W83v/uC6CyyOVykvP5vLBhI36kTJg1voE9AXm51WqhVqvJjHFcOCp894vJn4ChUEjYqEytMf4DaLJ26BrRH/WRNfWK/mmoh8xspKuoa8osY0PPVqsVhsMhRqORjAtXrN1uy/rt93tMJhOxgtvE8/F4lMxR45ZxPgkqkjkuvGzbtvjI9eJH9JGZoGzGZ67dbDaTJgTnzvMOR0kATcmUo6EW6LiYlqhk8zsdvQe/sNInydL5LgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='실제 피드백 내용... 더 많은 피드백이 있었다..' title='' src='/static/fe4345dbfe36a4add2a411a1606946ed/c0f59/3.png' srcset='/static/fe4345dbfe36a4add2a411a1606946ed/e7570/3.png 170w,\n/static/fe4345dbfe36a4add2a411a1606946ed/c0f59/3.png 251w' sizes='(max-width: 251px) 100vw, 251px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>실제 피드백 내용... 더 많은 피드백이 있었다..</figcaption>\n  </figure></p>\n<p>이전의 단순한 알고리즘으로는 모든 문서의 제목을 정확하게 추출하는 것은 힘들었다. 그리고 그것을 해결화는 과정에서 새로운 이슈도 발생했다.</p>\n<h3 id=\"이슈-1--Bounding-Box가-분리되어-나오는-현상\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EC%8A%88-1--Bounding-Box%EA%B0%80-%EB%B6%84%EB%A6%AC%EB%90%98%EC%96%B4-%EB%82%98%EC%98%A4%EB%8A%94-%ED%98%84%EC%83%81\" aria-label=\"이슈 1  Bounding Box가 분리되어 나오는 현상 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>이슈 1 : Bounding Box가 분리되어 나오는 현상</h3>\n<p><code class=\"language-text\">NAVER CLOVA OCR</code> 을 통해 이미지 혹은 PDF 파일에 대해 OCR 처리를 하게 되면 하나의 문장에 대해 정확하게 OCR 되는 경우도 있지만, 하나의 문장이라도 여러 단어와 조사 등으로 나뉘어 OCR 되는 경우가 있었다. </p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 312px; '>\n      <a class='gatsby-resp-image-link' href='/static/f94e341cf2d1a7bbcb3478d946d31d94/f00bc/2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 28.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEklEQVR42nWQS0vDUBCF83/dSjdutNhSS9qGiM1D0RRsUTfeWmxQtOLK2Gt8NEmlxCRQTXyhIqjRPOZ6XalYh7M4fOfMYoYh/w389jAiYuzEMKNuL9SsCFsf2Iqxm/T9xDPjrhEeUnie6FT9+MiiivDZmzZITy4SI4WU4bRcRWQL4vTWwSansFl2srKbr9+KE7MZfrFcWijKK9WOvl2t80Ux39pfLwi55WZtqp0JySszb5YanaXanqwaSFL5Jl5rWDJ6UMalsfYpUk2E9FUaKTuS0OKon9soqz0kHM+80+V7CC7B9okzTO0APB+cJ3L3As8BcX3iBuBegzcE+wocSmgzIB4tP8LN183f//ipkfBP5xPEhTMcuc3pcgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='분리되어 나오는 Bounding Box' title='' src='/static/f94e341cf2d1a7bbcb3478d946d31d94/f00bc/2.png' srcset='/static/f94e341cf2d1a7bbcb3478d946d31d94/e7570/2.png 170w,\n/static/f94e341cf2d1a7bbcb3478d946d31d94/f00bc/2.png 312w' sizes='(max-width: 312px) 100vw, 312px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>분리되어 나오는 Bounding Box</figcaption>\n  </figure></p>\n<p>위 이미지의 경우, <code class=\"language-text\">안전 관리 실무자 선임 문서</code> 가 제목이지만, 초기의 단순한 알고리즘을 통해 제목을 추출하면 <code class=\"language-text\">안전 관리</code> 혹은 <code class=\"language-text\">실무자 선임 문서</code> 중 하나만 제목으로 채택된다. 그래서 만약 Bounding Box가 분리되어 온다면 한 문장인 경우 서로 병합하여 계산할 필요가 있었다.</p>\n<h4 id=\"인접한-Bounding-Box-병합하기\" style=\"position:relative;\"><a href=\"#%EC%9D%B8%EC%A0%91%ED%95%9C-Bounding-Box-%EB%B3%91%ED%95%A9%ED%95%98%EA%B8%B0\" aria-label=\"인접한 Bounding Box 병합하기 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>인접한 Bounding Box 병합하기</h4>\n<p>앞서 이야기 했듯이 OCR 결과는 Bounding Box로 주어진다. 그리고 그 Box에는 <code class=\"language-text\">좌・상단</code>, <code class=\"language-text\">좌・하단</code>, <code class=\"language-text\">우・상단</code>, <code class=\"language-text\">우・하단</code> 좌표를 기반으로 만들어진다. 이 점을 이용하여 각 Box의 높이와 폭을 구할 수 있고, 이를 기반으로 인접한 다른 Bounding Box에 대한 거리 혹은 크기의 차이를 계산할 수 있다.</p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 312px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/f94e341cf2d1a7bbcb3478d946d31d94/f00bc/2.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 28.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAABEklEQVR42nWQS0vDUBCF83/dSjdutNhSS9qGiM1D0RRsUTfeWmxQtOLK2Gt8NEmlxCRQTXyhIqjRPOZ6XalYh7M4fOfMYoYh/w389jAiYuzEMKNuL9SsCFsf2Iqxm/T9xDPjrhEeUnie6FT9+MiiivDZmzZITy4SI4WU4bRcRWQL4vTWwSansFl2srKbr9+KE7MZfrFcWijKK9WOvl2t80Ux39pfLwi55WZtqp0JySszb5YanaXanqwaSFL5Jl5rWDJ6UMalsfYpUk2E9FUaKTuS0OKon9soqz0kHM+80+V7CC7B9okzTO0APB+cJ3L3As8BcX3iBuBegzcE+wocSmgzIB4tP8LN183f//ipkfBP5xPEhTMcuc3pcgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='2' title='' src='/static/f94e341cf2d1a7bbcb3478d946d31d94/f00bc/2.png' srcset='/static/f94e341cf2d1a7bbcb3478d946d31d94/e7570/2.png 170w,\n/static/f94e341cf2d1a7bbcb3478d946d31d94/f00bc/2.png 312w' sizes='(max-width: 312px) 100vw, 312px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>위 이미지를 기준으로 설명해보자면, <code class=\"language-text\">안전 관리</code> Box를 <code class=\"language-text\">Prev Box</code>라고 지칭하고, <code class=\"language-text\">실무자 선임 문서</code> Box 가 비교 대상이 된다. 이 둘을 같은 그룹으로 묶는 (같은 문장이라고 판단하는) 기준은 <code class=\"language-text\">안전 관리</code> Box에 대한 Width 및 Height를 기준으로 인접한 범위로 들 수 있는 범위를 정하고, 적절한 가중치를 더한다. </p>\n<p><span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 312px; margin-bottom: 16px;'>\n      <a class='gatsby-resp-image-link' href='/static/0bb7a6c246631886462784823377719d/f00bc/4.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 28.82352941176471%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAu0lEQVR42qWQwQqCQBCGff+gDt6lTdtdMExLojAv4q7Juh46+AxJ57rUzrZtIEEdgj4GZhj+geFzQGtTSikAUBYzaLsZAMtnxtGmKaXfgbuGm/4Bp+e8cd0pQlJKjOezgAgWX/sdJQEmFGOcpmnXdVEUUUrruvY8L89zxtjz+NQ0R0KWcSzbdhGGq/VGHraXM5+MR1m2L8uyKAohRJIkCCFz4/t+VVWcc/v2HzgvFYMSK8MogK+2hoyymh5Ol0bL/hcGiAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='4' title='' src='/static/0bb7a6c246631886462784823377719d/f00bc/4.png' srcset='/static/0bb7a6c246631886462784823377719d/e7570/4.png 170w,\n/static/0bb7a6c246631886462784823377719d/f00bc/4.png 312w' sizes='(max-width: 312px) 100vw, 312px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span></p>\n<p>쉽게 설명해보자면, 위 이미지에서 빨간색 영역은 <code class=\"language-text\">안전 관리</code> Box의 <code class=\"language-text\">Width 20%</code> 에 해당하는 영역이다. 그리고 해당 <code class=\"language-text\">안전 관리</code> Box의 범위를 끝에서 <code class=\"language-text\">빨간색 영역</code> 만큼 인접한 Bounding Box를 탐색한다. 여기서 노란색 박스가 실제 인접한 Bounding Box가 있는지 탐색하는 영역 범위이다. </p>\n<p>노란색 영역에 다른 Bounding Box가 있다면 그것은 서로 인접해있다는 의미이고, 같은 그룹 (같은 문장)으로 묶어도 된다는 의미이다.</p>\n<p>결과적으로 <code class=\"language-text\">안전 관리</code> 와 <code class=\"language-text\">실무자 선임 문서</code> 2개의 Bounding Box를 하나로 합쳐 <code class=\"language-text\">안전 관리 실무자 선임 문서</code>의 Box를 새로 생성한다.</p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 680px; '>\n      <a class='gatsby-resp-image-link' href='/static/10836aa059a74e5d9d396a17025f3531/b3831/5.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 27.647058823529413%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA1ElEQVR42mWOUYuDMBCE8///TS0tFgptD1+riGKiURsQrCSoD6KiNmnXhDvk+pGHnezMMuitUZr3hn/yGzAgHVJGSKW2V8yHWS3LIqV8bQCJ9pZ1As7nn9vtcr3eXfdk29bOsu3j4XhIkhjCZVlijMMwTNOUUhpFUVEUvu8jgkkSx0EQUJoSQmABDrA6jpNlmRAcwpzzruvGcRyGoe/7aZrMgP56rrWlVOtbB8M8z9CQMeZ5Xl3XlUYIAV3gIsrznLEHJhgaPquqaZv6l0bTtq2J8S8+lihMZ+a+Mt8AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='alt text' title='' src='/static/10836aa059a74e5d9d396a17025f3531/ca1dc/5.png' srcset='/static/10836aa059a74e5d9d396a17025f3531/e7570/5.png 170w,\n/static/10836aa059a74e5d9d396a17025f3531/f46e7/5.png 340w,\n/static/10836aa059a74e5d9d396a17025f3531/ca1dc/5.png 680w,\n/static/10836aa059a74e5d9d396a17025f3531/02d09/5.png 1020w,\n/static/10836aa059a74e5d9d396a17025f3531/9d567/5.png 1360w,\n/static/10836aa059a74e5d9d396a17025f3531/b3831/5.png 3342w' sizes='(max-width: 680px) 100vw, 680px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>alt text</figcaption>\n  </figure></p>\n<p>기존에는 위와 같은 문서 제목을 <code class=\"language-text\">안전보건교육일지 결 작성 검 토 승 인</code> 으로 인식되었다. 하지만 해당 병합 방식을 적용하고나서는 <code class=\"language-text\">안전보건교육일지</code> 로 정확하게 인식되었다. </p>\n<p>결국 이러한 병합 방식에서 중요한 것은 인접한 <code class=\"language-text\">Bounding Box</code> 를 탐색하는 범위를 어느 정도로 할 것이냐가 제일 중요하다.</p>\n<p>이 부분에 대해서 <code class=\"language-text\">Silver Bullet</code> 은 찾을 수 없다. 문서 크기에 대해서도 고려해야 하고, 길이와 높이에 대해서도 고려해보아야 한다. 결국 여러 가지 문서를 받아보고, 추출하면서 가중치를 조절하면서 통상적으로 많은 문서를 처리할 수 있는 가중치를 찾아야 한다.</p>\n<p>실제로 해당 기능을 고도화 하기 위해 긴 시간을 들여 가중치를 조절하며 최적의 값을 찾아나갔다. </p>\n<p><figure class='gatsby-resp-image-figure' style='margin-bottom: 16px;'>\n    <span class='gatsby-resp-image-wrapper' style='position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 272px; '>\n      <a class='gatsby-resp-image-link' href='/static/e092bd91f23f08ed3bc7e22873215a45/0a1dc/6.png' style='display: block' target='_blank' rel='noopener'>\n    <span class='gatsby-resp-image-background-image' style=\"padding-bottom: 141.76470588235293%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAcCAIAAADuuAg3AAAACXBIWXMAAAsTAAALEwEAmpwYAAACrElEQVR42mWVx5IiMRBE+f+f4cARLgwQHPA0ZvAeFhbP4AKY2ddKoe7drQgqStmqUpaRiPyE5PstzpYR/hreH/n5T6rVaiwWQ5fL5Wg0OhgMEolEPB4PBwqcgV6vF8Zut1utVs1mM5VKNRoNz/OSyWSv18vlctls9reRcIiIo4QejUaZTAaHdDrdarUKhcKHkXa7XalUOBz8X+fL5fJlBON4PJ5OJy33+/12uz2fz9iHw0E4S/bcbjffGcIQ63a7nU6n3++jWXKsEIHD4ZDMQaCAJq/pdGqdgcjw0whGvV7nMzYh0IoF3jICQixYWGfyUXkw+IZzrVbzjFBw2RjgaOKCLBYL6wwxWHECJKmZSGKgsX8ZoQs4TCYTNJwpQeAMc5zREHNps8R5uVzKeb1eY8/nc/ypnO/8fD7hDBOmAkowLBaLSsFRLZVKDmdJCzebje9M0zinYUR1knAsEZtGukZUVHGkqdZ5PB67JEmBJbmh2QSI7hshBUIMjWjUfNrEI7yKrD6ppCRC5vDXV1FTRygBp9o+k4w6jHYUOEeNECIubCbh6/XqO/ObzWagNED7VFh2cE8YTxgypyzBsQGxbbU5eWBEDUPDSsOoc6DKUgafwMmF8bY5e28hSZizg4Q1nsIBdb3dtMHlryHRmRpd1xL8wWG7NrJ5i+6/70yeYyPswwFDFXKlQjNVlGb6lvv9bmkTXn3SrdCoAYIwquqQWqi8wKl20Gf5s89NpQJpznRndCUpGOP9eDzshDFP6idaIyXOmjyWZKtuIdg8JjZnTtbjoPukxwTRM8DhIHzVYwARcNgRwjqHL5DuUz6f5yaRITdJnVOTpKETvGHEJiqQO1npubfNibvwwcUgN82TG2m9IZozfRJIdSCMp31JKNjdCEzCRngpwVaR3T/GHypQ1BLFGpN7AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <img class='gatsby-resp-image-image' alt='두 줄로 이루어진 제목의 문서 예시' title='' src='/static/e092bd91f23f08ed3bc7e22873215a45/0a1dc/6.png' srcset='/static/e092bd91f23f08ed3bc7e22873215a45/e7570/6.png 170w,\n/static/e092bd91f23f08ed3bc7e22873215a45/0a1dc/6.png 272w' sizes='(max-width: 272px) 100vw, 272px' style='width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;' loading='lazy' decoding='async'>\n  </a>\n    </span>\n    <figcaption class='gatsby-resp-image-figcaption'>두 줄로 이루어진 제목의 문서 예시</figcaption>\n  </figure></p>\n<p>추가적으로 여러 줄에 걸쳐 구성된 제목의 문서도 X좌표 상에서 인접한 Bounding Box를 찾는 것처럼 Y좌표 상에서 인접한 Bounding Box를 탐색하는 방법으로 여러 줄에 걸친 제목을 병합할 수 있었다.</p>\n<h3 id=\"이슈-2--제목-후보-별-점수-스코어링\" style=\"position:relative;\"><a href=\"#%EC%9D%B4%EC%8A%88-2--%EC%A0%9C%EB%AA%A9-%ED%9B%84%EB%B3%B4-%EB%B3%84-%EC%A0%90%EC%88%98-%EC%8A%A4%EC%BD%94%EC%96%B4%EB%A7%81\" aria-label=\"이슈 2  제목 후보 별 점수 스코어링 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>이슈 2 : 제목 후보 별 점수 스코어링</h3>\n<p>두 번째 문제는 바로 문서의 제목이 바로 다양한 위치에 있을 수 있다는 것이었다. </p>\n<p><code class=\"language-text\">PPT</code> 기반으로 작성한 문서의 경우 제목은 중간에 위치해있고, <code class=\"language-text\">Word</code>, <code class=\"language-text\">Hwp</code> 를 통해 작성한 문서는 대부분 상단 중앙에 위치해있다. </p>\n<p>이런 모든 케이스를 고려하여 애플리케이션 로직으로만 해결하는 것은 매우 해결하기 어려웠다. 그래서 여러가지 요소들을 종합해서 문장 후보를 선별하고, 그 기준을 통해 점수를 도입하기로 했다.</p>\n<p>각각 평가하고자 하는 요소들은 다음과 같다.</p>\n<ul>\n<li><strong>위치</strong></li>\n<li><strong>크기</strong></li>\n<li><strong>길이</strong></li>\n</ul>\n<p>각 세부 요소에 대해서 어떤식으로 기준을 잡았는지에 대해서는 이야기 할 수 없지만, 각각의 문장들을 위치, 크기, 길이에 대해서 제목과 유사한 특징을 가질 수록 높은 점수를 주고 가장 점수가 높은 문장을 제목으로 선정하는 방식이다.</p>\n<p>좀 더 설명해보자면, 3가지의 <code class=\"language-text\">위치</code>, <code class=\"language-text\">크기</code>, <code class=\"language-text\">길이</code> 중 제목으로서 가장 중요하게 평가하는 항목이 있고, 가장 덜 중요한 항목이 있다. </p>\n<p>예를 들어 문서 하단에 제목이 위치하는 문서라고 가정해보자. 만약 위치에 대해 중앙 상단을 중점으로 문서의 제목을 결정한다면 실제 제목이 하단에 존재하더라도, 부가 정보를 중앙 상단에 적어놓았더라면 부가 정보가 제목으로 선정된다. </p>\n<p>이는 잘못된 방식이다. </p>\n<p>이런 케이스를 고려하기 위해서 각 항목마다 적절한 가중 점수를 부여하고, 각 특징에 대해서 점수를 부여하는 방법이다. 중요한 것은 각각의 가중치이라고 할 수 있다. 이는 내부에 정해진 문서 데이터를 기반으로 결정했다.</p>\n<h3 id=\"결과\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EA%B3%BC\" aria-label=\"결과 permalink\" class=\"heading-anchor before\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"15\" viewBox=\"0 0 24 24\"><path d=\"M6.188 8.719c.439-.439.926-.801 1.444-1.087 2.887-1.591 6.589-.745 8.445 2.069l-2.246 2.245c-.644-1.469-2.243-2.305-3.834-1.949-.599.134-1.168.433-1.633.898l-4.304 4.306c-1.307 1.307-1.307 3.433 0 4.74 1.307 1.307 3.433 1.307 4.74 0l1.327-1.327c1.207.479 2.501.67 3.779.575l-2.929 2.929c-2.511 2.511-6.582 2.511-9.093 0s-2.511-6.582 0-9.093l4.304-4.306zm6.836-6.836l-2.929 2.929c1.277-.096 2.572.096 3.779.574l1.326-1.326c1.307-1.307 3.433-1.307 4.74 0 1.307 1.307 1.307 3.433 0 4.74l-4.305 4.305c-1.311 1.311-3.44 1.3-4.74 0-.303-.303-.564-.68-.727-1.051l-2.246 2.245c.236.358.481.667.796.982.812.812 1.846 1.417 3.036 1.704 1.542.371 3.194.166 4.613-.617.518-.286 1.005-.648 1.444-1.087l4.304-4.305c2.512-2.511 2.512-6.582.001-9.093-2.511-2.51-6.581-2.51-9.092 0z\"/></svg></a>결과</h3>\n<p>두 가지 이슈를 해결하니, 기존에 준비한 수많은 테스트 문서에 대해 대부분 정확히 제목을 인식할 수 있었다. OCR 상에서 정확하게 특정할 수 없는 <code class=\"language-text\">특수문자(./])</code> 에 대한 이슈가 살짝 있었지만</p>\n<p><strong>대체적으로 성공적인 제목 추출을 보여줬고, 기존에 준비한 100여개의 테스트 문서 중 90% 이상의 제목 추출 정확도를 확인할 수 있었다.</strong></p>\n<p>회사에서 진행한 프로젝트의 내용이기 때문에 상세한 내용은 이야기 못해서 아쉽지만, 처음에 한계라고 느꼈던 이슈를 긴 시간 동안의 점진적 개선을 통해 해결한 케이스이기 때문에 소중한 경험이라고 생각하고 있다.</p>\n<p>추가적으로 LLM을 이용하면 더 정확한 제목을 추출할 수 있다.</p>\n<p>그럼 초기부터 LLM을 쓰면 되지 않느냐 라고 생각할 수 있겠지만, 어떠한 기술이나 솔루션을 도입할 때 <code class=\"language-text\">Trade Off</code> 를 항상 생각해봐야 한다. </p>\n<p>서비스 기획 및 개발 초기 당시, LLM을 활용한 제목 추정 기능은 벤처성으로 기획된 프로젝트이기 때문에 계획되지 않았지만, 이후 챗봇 개발 기획 등을 통해 도입할 수 있었다.</p>\n<p>또한 LLM은 Token을 기반으로 비용을 책정하기 때문에, 위 알고리즘을 통해 LLM에 넘기는 파라미터의 Token 수를 줄여 비용 절감을 할 수 있다는 장점으로 이어진다. </p>\n<p>기능이 들어간 서비스의 제목 추출 기능은 현재도 문제 없이 잘 돌아가고 있다. 😀</p>","frontmatter":{"title":"OCR 기반 제목 추출 알고리즘 개선기","date":"July 09, 2025","update":"July 09, 2025","tags":["이슈","정확도 개선","문서 제목 추출"],"series":"이슈 해결 사례"},"fields":{"slug":"/ocr/","readingTime":{"minutes":12.11}}},"seriesList":{"edges":[{"node":{"id":"23296bb3-0599-505a-9428-18da13466758","fields":{"slug":"/nfd-nfc/"},"frontmatter":{"title":"문자열이 자소분리가 되어 DB 저장되는 이슈 해결"}}},{"node":{"id":"d5c52b55-5a00-5a23-8159-1b8e49774824","fields":{"slug":"/ocr/"},"frontmatter":{"title":"OCR 기반 제목 추출 알고리즘 개선기"}}}]},"previous":{"fields":{"slug":"/nfd-nfc/"},"frontmatter":{"title":"문자열이 자소분리가 되어 DB 저장되는 이슈 해결"}},"next":null},"pageContext":{"id":"d5c52b55-5a00-5a23-8159-1b8e49774824","series":"이슈 해결 사례","previousPostId":"23296bb3-0599-505a-9428-18da13466758","nextPostId":null}},"staticQueryHashes":[],"slicesMap":{}}